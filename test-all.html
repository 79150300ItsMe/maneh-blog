<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete SEO Test Suite</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .pass { background-color: #d4edda; border-color: #c3e6cb; }
        .fail { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        #results { margin-top: 20px; }
        .test-summary { margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 5px; }
        .test-summary.pass { background: #d4edda; }
        .test-summary.fail { background: #f8d7da; }
        .progress-bar { width: 100%; height: 20px; background: #e9ecef; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: #28a745; transition: width 0.3s ease; }
    </style>
</head>
<body>
    <h1>Complete SEO Test Suite</h1>
    
    <div class="test-section info">
        <h3>Test Instructions</h3>
        <p>1. Open this page in the same domain as your blog</p>
        <p>2. Click "Run All Tests" to verify everything</p>
        <p>3. Check console for detailed results</p>
    </div>
    
    <div class="test-section">
        <h3>Test Controls</h3>
        <button onclick="runAllTests()">Run All Tests</button>
        <button onclick="testBasic()">Test Basic</button>
        <button onclick="testAdvanced()">Test Advanced</button>
        <button onclick="clearResults()">Clear Results</button>
    </div>
    
    <div class="test-section">
        <h3>Progress</h3>
        <div class="progress-bar">
            <div class="progress-fill" id="progress" style="width: 0%"></div>
        </div>
        <div id="progress-text">Ready to start...</div>
    </div>
    
    <div id="results"></div>

    <script>
        let testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };

        function log(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-section ${type}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            // Update counters
            if (type === 'pass') testResults.passed++;
            else if (type === 'fail') testResults.failed++;
            else if (type === 'warning') testResults.warnings++;
            testResults.total++;
            
            updateProgress();
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            const progressText = document.getElementById('progress-text');
            
            if (testResults.total > 0) {
                const percentage = (testResults.passed / testResults.total) * 100;
                progress.style.width = `${percentage}%`;
                progressText.textContent = `${testResults.passed}/${testResults.total} tests passed (${percentage.toFixed(1)}%)`;
            }
        }

        function testBasic() {
            log('Running Basic Tests...', 'info');
            clearResults();
            
            // Test 1: Console Errors
            testConsoleErrors();
            
            // Test 2: Meta Tags
            testMetaTags();
            
            // Test 3: Structured Data
            testStructuredData();
            
            // Test 4: AdSense Compliance
            testAdSenseCompliance();
        }

        function testAdvanced() {
            log('Running Advanced Tests...', 'info');
            clearResults();
            
            // Test 1: Lighthouse SEO
            testLighthouseSEO();
            
            // Test 2: Performance
            testPerformance();
            
            // Test 3: Accessibility
            testAccessibility();
            
            // Test 4: Security
            testSecurity();
        }

        function runAllTests() {
            log('Running Complete Test Suite...', 'info');
            clearResults();
            
            testBasic();
            testAdvanced();
            
            // Final summary
            setTimeout(() => {
                showSummary();
            }, 1000);
        }

        function testConsoleErrors() {
            log('Testing Console Errors...', 'info');
            
            const errorPatterns = [
                'ReferenceError',
                'TypeError',
                'undefined is not a function',
                'Cannot read property',
                'runUrl is not defined',
                'fullUrl is not defined'
            ];
            
            let hasErrors = false;
            errorPatterns.forEach(pattern => {
                if (console.error && console.error.toString().includes(pattern)) {
                    log(`✗ Console error found: ${pattern}`, 'fail');
                    hasErrors = true;
                }
            });
            
            if (!hasErrors) {
                log('✓ No console errors found', 'pass');
            }
        }

        function testMetaTags() {
            log('Testing Meta Tags...', 'info');
            
            // Title
            const title = document.title;
            if (title && title.length > 0) {
                log('✓ Title present', 'pass');
                if (title.length <= 65) {
                    log('✓ Title length OK', 'pass');
                } else {
                    log('✗ Title too long', 'fail');
                }
            } else {
                log('✗ No title', 'fail');
            }
            
            // Meta description
            const desc = document.querySelector('meta[name="description"]');
            if (desc && desc.content) {
                log('✓ Meta description present', 'pass');
                if (desc.content.length <= 155) {
                    log('✓ Description length OK', 'pass');
                } else {
                    log('✗ Description too long', 'fail');
                }
            } else {
                log('✗ No meta description', 'fail');
            }
            
            // Canonical
            const canon = document.querySelector('link[rel="canonical"]');
            if (canon && canon.href) {
                log('✓ Canonical present', 'pass');
            } else {
                log('✗ No canonical', 'fail');
            }
            
            // Open Graph
            const ogTags = ['og:title', 'og:description', 'og:image', 'og:url'];
            let ogCount = 0;
            ogTags.forEach(tag => {
                if (document.querySelector(`meta[property="${tag}"]`)) {
                    ogCount++;
                }
            });
            
            if (ogCount === ogTags.length) {
                log('✓ All Open Graph tags present', 'pass');
            } else {
                log(`✗ Missing ${ogTags.length - ogCount} Open Graph tags`, 'fail');
            }
            
            // Twitter Cards
            const twTags = ['twitter:card', 'twitter:title', 'twitter:description', 'twitter:image'];
            let twCount = 0;
            twTags.forEach(tag => {
                if (document.querySelector(`meta[name="${tag}"]`)) {
                    twCount++;
                }
            });
            
            if (twCount === twTags.length) {
                log('✓ All Twitter Card tags present', 'pass');
            } else {
                log(`✗ Missing ${twTags.length - twCount} Twitter Card tags`, 'fail');
            }
        }

        function testStructuredData() {
            log('Testing Structured Data...', 'info');
            
            const jsonLdScripts = document.querySelectorAll('script[type="application/ld+json"]');
            
            if (jsonLdScripts.length === 0) {
                log('✗ No structured data found', 'fail');
                return;
            }
            
            log(`✓ Found ${jsonLdScripts.length} structured data script(s)`, 'pass');
            
            jsonLdScripts.forEach((script, index) => {
                try {
                    const data = JSON.parse(script.textContent);
                    
                    if (data['@context'] === 'https://schema.org') {
                        log(`✓ Script ${index + 1} has correct @context`, 'pass');
                    } else {
                        log(`✗ Script ${index + 1} has incorrect @context`, 'fail');
                    }
                    
                    if (data['@type']) {
                        log(`✓ Script ${index + 1} has @type: ${data['@type']}`, 'pass');
                    } else {
                        log(`✗ Script ${index + 1} missing @type`, 'fail');
                    }
                    
                } catch (e) {
                    log(`✗ Script ${index + 1} is not valid JSON`, 'fail');
                }
            });
        }

        function testAdSenseCompliance() {
            log('Testing AdSense Compliance...', 'info');
            
            // Check CSP
            const cspMeta = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
            if (cspMeta) {
                log('✓ CSP meta tag found', 'pass');
                
                const requiredDomains = [
                    'www.googletagmanager.com',
                    'pagead2.googlesyndication.com',
                    'googleads.g.doubleclick.net'
                ];
                
                let foundDomains = 0;
                requiredDomains.forEach(domain => {
                    if (cspMeta.content.includes(domain)) {
                        foundDomains++;
                    }
                });
                
                if (foundDomains === requiredDomains.length) {
                    log('✓ All required AdSense domains in CSP', 'pass');
                } else {
                    log(`✗ Only ${foundDomains}/${requiredDomains.length} domains in CSP`, 'fail');
                }
            } else {
                log('✗ No CSP meta tag found', 'fail');
            }
            
            // Check AdSense script
            const adsenseScript = document.querySelector('script[src*="adsbygoogle.js"]');
            if (adsenseScript) {
                log('✓ AdSense script found', 'pass');
            } else {
                log('✗ AdSense script not found', 'fail');
            }
            
            // Check AdSense meta
            const adsenseMeta = document.querySelector('meta[name="google-adsense-account"]');
            if (adsenseMeta) {
                log('✓ AdSense account meta found', 'pass');
            } else {
                log('✗ AdSense account meta not found', 'fail');
            }
        }

        function testLighthouseSEO() {
            log('Testing Lighthouse SEO...', 'info');
            
            // Test title length
            const title = document.title;
            if (title && title.length <= 60) {
                log('✓ Title length optimal for Lighthouse', 'pass');
            } else if (title && title.length <= 65) {
                log('⚠ Title length acceptable for Lighthouse', 'warning');
            } else {
                log('✗ Title length suboptimal for Lighthouse', 'fail');
            }
            
            // Test meta description length
            const desc = document.querySelector('meta[name="description"]');
            if (desc && desc.content) {
                if (desc.content.length >= 120 && desc.content.length <= 155) {
                    log('✓ Meta description length optimal for Lighthouse', 'pass');
                } else if (desc.content.length >= 100 && desc.content.length <= 160) {
                    log('⚠ Meta description length acceptable for Lighthouse', 'warning');
                } else {
                    log('✗ Meta description length suboptimal for Lighthouse', 'fail');
                }
            }
        }

        function testPerformance() {
            log('Testing Performance...', 'info');
            
            // Test preconnect links
            const preconnects = document.querySelectorAll('link[rel="preconnect"]');
            if (preconnects.length > 0) {
                log(`✓ Found ${preconnects.length} preconnect links`, 'pass');
            } else {
                log('✗ No preconnect links found', 'fail');
            }
            
            // Test DNS prefetch
            const prefetches = document.querySelectorAll('link[rel="dns-prefetch"]');
            if (prefetches.length > 0) {
                log(`✓ Found ${prefetches.length} DNS prefetch links`, 'pass');
            } else {
                log('✗ No DNS prefetch links found', 'fail');
            }
            
            // Test font loading
            const fonts = document.querySelectorAll('link[href*="fonts.googleapis.com"]');
            if (fonts.length > 0) {
                log('✓ Google Fonts loaded', 'pass');
            } else {
                log('✗ No Google Fonts found', 'fail');
            }
        }

        function testAccessibility() {
            log('Testing Accessibility...', 'info');
            
            // Test alt attributes
            const images = document.querySelectorAll('img');
            let imagesWithoutAlt = 0;
            images.forEach(img => {
                if (!img.alt) {
                    imagesWithoutAlt++;
                }
            });
            
            if (imagesWithoutAlt === 0) {
                log('✓ All images have alt attributes', 'pass');
            } else {
                log(`✗ ${imagesWithoutAlt} images missing alt attributes`, 'fail');
            }
            
            // Test heading structure
            const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
            if (headings.length > 0) {
                log(`✓ Found ${headings.length} headings`, 'pass');
            } else {
                log('✗ No headings found', 'fail');
            }
        }

        function testSecurity() {
            log('Testing Security...', 'info');
            
            // Test HTTPS
            if (location.protocol === 'https:') {
                log('✓ Using HTTPS', 'pass');
            } else {
                log('⚠ Not using HTTPS', 'warning');
            }
            
            // Test CSP
            const cspMeta = document.querySelector('meta[http-equiv="Content-Security-Policy"]');
            if (cspMeta) {
                log('✓ CSP meta tag present', 'pass');
            } else {
                log('✗ No CSP meta tag found', 'fail');
            }
        }

        function showSummary() {
            const summary = document.createElement('div');
            summary.className = `test-summary ${testResults.failed === 0 ? 'pass' : 'fail'}`;
            
            const passRate = ((testResults.passed / testResults.total) * 100).toFixed(1);
            
            summary.innerHTML = `
                <h3>Test Summary</h3>
                <p><strong>Total Tests:</strong> ${testResults.total}</p>
                <p><strong>Passed:</strong> ${testResults.passed}</p>
                <p><strong>Failed:</strong> ${testResults.failed}</p>
                <p><strong>Warnings:</strong> ${testResults.warnings}</p>
                <p><strong>Pass Rate:</strong> ${passRate}%</p>
                <p><strong>Status:</strong> ${testResults.failed === 0 ? '✅ All tests passed!' : '❌ Some tests failed'}</p>
            `;
            
            document.getElementById('results').appendChild(summary);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            testResults = { total: 0, passed: 0, failed: 0, warnings: 0 };
            updateProgress();
        }

        // Auto-run basic tests on load
        window.addEventListener('load', () => {
            log('Complete SEO Test Suite loaded', 'info');
            log('Click "Run All Tests" to start comprehensive verification', 'info');
        });
    </script>
</body>
</html>
